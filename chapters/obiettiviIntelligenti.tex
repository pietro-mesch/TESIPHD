\chapter{Smart Objectives} \label{c:objectives}
\todo{Definizione degli obiettivi dell'ottimizzazione classica e di quella sostenibile.}

\section{The Optimisation Dilemma}
\todo{Present the Big Question: are we really optimising? Are adaptive signals doing us any good?
\begin{itemize}
\item Signal optimisation sounds good but basically \emph{identifies} with increasing the supply, increasing throughput, increasing flows.
\item Not only this is of \emph{extremely} dubious benefit to our cities, health and safety, but even in the short term it seems like there hasn't been too much thought whether it really is beneficial to traffic to maximise e.g. bandwidth if this only means piling up earlier and more heavily a few junctions down the road.
\item It is true that it is extremely hard to model these effects explicitly, which is why we wish to attempt a heuristic approach that may help investigate the consequences of different choices, and maybe reverse-engineer a more structured logic.
\item For the present work it is necessary to put aside the cold hard fact that the only way to alleviate traffic is to discourage people from relying on private transport.
\item The plan is to try and see if at least we can be sure we are actually \emph{reducing} the short term discomfort and external costs of driving.
\end{itemize}
}

\todo{Refer to the model outputs as described in section \ref{s:output}}

\subsection{Fundamental Quantities}
The following quantities are calculated on the corridor over the entire simulation, and represent the reference quantities for calculation of key performance indicators.

The subscript $T$ is often dropped for readability, but is \emph{implied} for all quantities aggregated at the simulation span level and presented in the following section. 

\subsubsection*{Section and Corridor Total}
The \emph{section total} is defined as the integral of the inflow to a given section of the corridor $a \in \corridor$, obtained piecewise in this case, as the total number of vehicles entered during each interval of the simulation window:
\eq[.]{eq:stotal}{
\total{a} \; = \sum_{\tau \in \simspan} \flow_{a,\tau} \simintd
}

The \emph{corridor total} gives an aggregate measure of how frequented the corridor is on the whole: it does not carry information on which sections are busier, but accounts for all vehicles that accessed \emph{any} section during the simulation.

It is obtained as the cumulative total over all corridor sections, according to
\eq[.]{eq:ctotal}{
\total{\corridor} \; = \sum_{a \in \corridor} \total{a}
}

Notice that $\total{a}$ implies no distinction based on whether the flows are coming from the previous section of the corridor or from a cordon arc, therefore vehicles travelling on more than one section are counted several times. 
This reflects the fact that the corridor is being used \emph{more} if vehicles travel a greater portion of it than if they only were to use one section.

The total inflow index $\total{\corridor}$ covers an important role as a \emph{checksum}, since it ensures that any improvements in other cumulative indices are not really due to the corridor accepting fewer vehicles because of a deterioration in the traffic conditions.

\subsubsection*{User Time Spent and User Time Travelled}
The most direct way to calculate how much time is spent by users on the corridor during the simulation window is to integrate the total number of vehicles present on any section over all time intervals. The total and section \emph{User Time Spent} can be expressed as
\eq{eq:utspent}{
\utspent{\corridor} \; = \sum_{a \in \corridor} \utspent{a} \qquad \mathrm{where}
\qquad \utspent{a} = \sum_{\tau \in \simspan} \nveh{a,\tau} \simintd
}
therefore accounting for any vehicles already on the corridor at the start of the simulation, but not for the time that will be spent to get out of it beyond the end of the look-ahead window.
However, since it is impossible to know how much time the vehicles have \emph{already} spent on the corridor when the simulation begins, nor how far they have got down the arc they're found on, the time spent $\utspent{}$ is not suitable for estimating the corridor performance with respect to travelled distances. 

Disregarding the initial vehicles $\nveh{\corridor}$ and only considering flows that enter a corridor section during the simulation, it is possible to extrapolate from the results exactly how much time those vehicles will spend \emph{travelling} the length of each arc, even beyond the end of the simulation. The average \emph{User Time Travelled} is still a measure of time, but obtained from flows and travel times as
\eq[.]{eq:uttravelled}{
\uttravelled{a} = \sum_{\tau \in \simspan} \traveltime{a,\tau} \; \flow_{a,\tau} \; \simintd
}

\subsection{Performance Indicators}

\subsubsection{Minutes per Kilometre Travelled}
From the user point of view, it makes sense to evaluate the performance of the corridor by considering the time required to travel the desired distance.

Referring to the User Time Travelled $\uttravelled{a}$ expressed by \eqref{eq:uttravelled} the \emph{Minutes per Kilometre} cost function
\eq[]{eq:timedist}{
\timedist{\corridor} =
\sum_{a \in \arcset} 
\frac{\uttravelled{a}}{\length_a \: \total{\corridor}}
}
uses the travel times experienced by all users, normalised with respect to the relevant section lengths and averaged over all vehicles involved with any part of the corridor during the simulation. This gives an overall measure of the fluidity of traffic on the corridor, and has the dimensions of a time per unit length. The choice of units (and name) for this performance indicator is therefore dictated solely by human-readability: it makes sense to count minutes spent in traffic to cover one kilometre, and it is easy to refer to the fact that for an average speed of 60 km/h the value of $\timedist{}$ would be 1.

\subsubsection{Stop Ratio}


\subsubsection{Congestion}



\subsection{Dynamic Weighting}



Formalizzazione delle funzioni di costo:
l'indice di coda (integrale tempo in coda per veicoli)/tempo passato nel corridoio fa
$$
\frac{\sum_{a \in C} \sum_{t \in T}{queu_{at}}}{\sum_{a \in C} \sum_{t \in T}{n_{at}}}
$$

non è reattivo soprattutto se gli archi sono lunghi perché il tempo in coda è comunque poco rispetto al totale


Numero di fermate non è male, calcolato come integrale dell'aumento della QUEU in ogni intervallo, corretto aggiungendo l'eventuale deflusso se la coda alla fine dell'intervallo non si è azzerata.
Questo comporta degli errori (da quantificare esattamente?) negli intervalli in cui la coda comincia o finisce.
$$
\sum_{a \in C} \sum_{t \in T} QUEU_{a,t} - QUEU_{a,t-1} + OFLW_{a,t} \Delta t
$$

Il tutto è da normalizzare rispetto al numero di veicoli entrati su qualsiasi arco.


Altro obiettivo utile sarebbe guardare la congestione degli archi.
Prendendo la congestione media si auto-pesano di più gli archi corti, il che avrebbe senso.
Come indicatore della congestione, dal GLTM prendiamo la lunghezza della coda peggiore nell'intervallo rispetto all'arco $QUEL\in[0,1]$ quindi come funzione di costo
\eq{e:maxqueue}{
Q_{a}^{MAX} = \sup\{QUEL_{a,t}|t\in T\}
}

Prendendo invece la lunghezza totale della coda?


\subsection{Cost Function Correlation}
